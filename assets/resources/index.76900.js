window.__require=function t(e,r,a){function i(c,s){if(!r[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var u="function"==typeof __require&&__require;if(!s&&u)return u(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var o=r[c]={exports:{}};e[c][0].call(o.exports,function(t){return i(e[c][1][t]||t)},o,o.exports,t,e,r,a)}return r[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<a.length;c++)i(a[c]);return i}({MultTextures:[function(t,e,r){"use strict";cc._RF.push(e,"9adc5aULtFMOZEhCtCp6XHg","MultTextures"),r.getMultMaterial=r.MultBatch2D=void 0;var a=t("./MultUtils");cc.Component.prototype.useMult=!1;var i={texture:null,defalut:new cc.Texture2D,getImpl:function(){return this.texture}};cc.gfx.Texture2D.prototype.texID=-1;var n=0,c=!1,s=[];r.MultBatch2D={enable:!1,parent:null,curID:0,incID:0,count:0,hash:0,reset:function(){this.count>0&&this.curID++,this.incID+=this.count,this.count=0},clear:function(){for(var t=s,e=0;e<t.length;e++){var r=t[e];r.destroy(),r.decRef()}s.length=0}};var l=function(){r.MultBatch2D.enable=!1,cc.resources.load("multTextures/Mult-material",cc.Material,function(t,e){if(!t){var i=cc.Material.getBuiltinMaterial("2d-sprite");i&&(r.MultBatch2D.hash=a.getMaterialHash(i),r.MultBatch2D.parent=e,r.MultBatch2D.enable=!0,e.addRef())}})};r.getMultMaterial=function(t){if(r.MultBatch2D.reset(),c=!1,!r.MultBatch2D.enable||!t||!t.isMultTextures)return t;if(!r.MultBatch2D.parent||!r.MultBatch2D.parent.isValid)return l(),t;var e=s[n++];if(!e||!e.isValid){e=new(0,cc.MaterialVariant)(r.MultBatch2D.parent),s[n-1]=e;for(var a=0;a<8;a++)e.setProperty("texture"+a,i.defalut);e.updateHash(r.MultBatch2D.hash),e.define("USE_TEXTURE",!0),e.isMultTextures=!0,e.cacheTextures=[-1],e.addRef()}return c=!0,e};var u=function(t,e){var r=t._assembler._renderData;if(!r)return!1;var a=0,i=r.vDatas[0];if(t.dataDirty){t.dataDirty=!1;for(var n=0,c=i.length;n<c;n+=5)a=~~(1e5*i[n+2]),i[n+2]=10*a+e}else if(t.texID!=e)for(n=0,c=i.length;n<c;n+=5)a=~~(.1*i[n+2]),i[n+2]=10*a+e;t.texID=e},o=function(t,e,a){if(c&&e){var n=e.effect.passes[0].getProperty("texture");n||(console.warn(t.node.name," texture lost !!!!!"),e.setProperty("texture",i.defalut),n=i.defalut);var s=r.MultBatch2D,l=(e.effect,n.texID-s.incID);if(l<0){s.count>=8&&(a._flush(),a.material=r.getMultMaterial(e),e.getDefine("CC_USE_MODEL")?a.node=t.node:a.node=a._dummyNode),l=s.count++,n.texID=l+s.incID;var o=a.material,h=o.cacheTextures;h[l]!==n._id&&(h[l]=n._id,i.texture=n,o.setProperty("texture"+l,i),o.effect._dirty=!1,o._dirty=!1)}u(t,l)}},h=function(){var t=cc.RenderComponent.prototype;t.texID=-1,t.vDitry=!0,t.dataDirty=!0,Object.defineProperty(t,"_vertsDirty",{get:function(){return this.vDitry},set:function(t){!t&&this.vDitry&&(this.dataDirty=!0),this.vDitry=t}});var e=t.setMaterial;t.setMaterial=function(t,r){var a=e.call(this,t,r);return this.setVertsDirty(),a};var i=cc.Material.prototype,c=i.getHash;i.getHash=function(){var t=this._effect;if(r.MultBatch2D.enable&&t&&t._dirty){this.isMultTextures=!1;var e=this._owner;if(e&&(e.useMult||e instanceof cc.Sprite||e instanceof cc.Label)){var i=a.getMaterialHash(this);if(i==r.MultBatch2D.hash)return this.isMultTextures=!0,t._dirty=!1,t._hash=i,i}}return c.call(this)},t._checkBacth=function(t,e){var a=this._materials[0];(a&&a.getHash()!==t.material.getHash()||t.cullingMask!==e)&&(t._flush(),a.getDefine("CC_USE_MODEL")?t.node=this.node:t.node=t._dummyNode,t.material=r.getMultMaterial(a),t.cullingMask=e),o(this,a,t)},cc.director.on(cc.Director.EVENT_BEFORE_DRAW,function(){n=0,r.MultBatch2D.reset(),r.MultBatch2D.curID=0})};cc.game.on(cc.game.EVENT_GAME_INITED,function(){l(),h()}),cc._RF.pop()},{"./MultUtils":"MultUtils"}],MultUtils:[function(t,e,r){"use strict";cc._RF.push(e,"4cc4f2NmTJMGaluoWmweHIF","MultUtils"),r.getMaterialHash=r.murmurhash2=r.serializeUniforms=r.serializePasses=r.serializePass=r.serializeDefines=void 0;var a=[];function i(t,e){for(var r=e.length,i=0;i<r;i++){var n=e[i];a[i]=n+t[n]}return a.length=r,a.join("")}function n(t,e){void 0===e&&(e=!1);var r=t._programName+t._cullMode;return t._blend&&(r+=t._blendEq+t._blendAlphaEq+t._blendSrc+t._blendDst+t._blendSrcAlpha+t._blendDstAlpha+t._blendColor),t._depthTest&&(r+=t._depthWrite+t._depthFunc),t._stencilTest&&(r+=t._stencilFuncFront+t._stencilRefFront+t._stencilMaskFront+t._stencilFailOpFront+t._stencilZFailOpFront+t._stencilZPassOpFront+t._stencilWriteMaskFront+t._stencilFuncBack+t._stencilRefBack+t._stencilMaskBack+t._stencilFailOpBack+t._stencilZFailOpBack+t._stencilZPassOpBack+t._stencilWriteMaskBack),r+=i(t._defines,t._defineNames),e||(r+=s(t._properties,t._propertyNames)),r}function c(t,e){void 0===e&&(e=!1);for(var r="",a=0;a<t.length;a++)r+=n(t[a],e);return r}function s(t,e){for(var r=0,i=0,n=e.length;i<n;i++){var c=t[e[i]].value;c&&null==c._id&&(a[r]=c.toString(),r++)}return a.length=r,a.join(";")}function l(t,e){for(var r,a=t.length,i=e^a,n=0;a>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++n;switch(a){case 3:i^=(255&t.charCodeAt(n+2))<<16;case 2:i^=(255&t.charCodeAt(n+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(n)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}r.serializeDefines=i,r.serializePass=n,r.serializePasses=c,r.serializeUniforms=s,r.murmurhash2=l,r.getMaterialHash=function(t){var e="",r=t._effect;return r&&(e+=c(r.passes,!1)),l(e,666)},cc._RF.pop()},{}]},{},["MultTextures","MultUtils"]);